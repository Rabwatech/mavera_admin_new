(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{44946:function(e,n,r){Promise.resolve().then(r.bind(r,26911))},26911:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return u}});var t=r(64090),a=r(47907),i=r(46960),s=r(53537);function u(){let{user:e}=(0,i.aC)(),n=(0,a.useRouter)();return(0,t.useEffect)(()=>{if(null==e?void 0:e.role){if(e.role===s.i.SUPER_ADMIN){n.replace("/admin");return}if(e.role===s.i.SALES_AGENT){n.replace("/sales-dashboard");return}if(e.role===s.i.CALL_CENTER){n.replace("/leads");return}if(e.role===s.i.FINANCE_MANAGER){n.replace("/admin/finance");return}n.replace("/sales-dashboard")}},[null==e?void 0:e.role,n]),null}},46960:function(e,n,r){"use strict";r.d(n,{Ho:function(){return o},aC:function(){return c},gI:function(){return l},i4:function(){return i.i}});var t=r(3827),a=r(64090),i=r(53537);let s={[i.i.SUPER_ADMIN]:["finance.view","finance.manage_invoices","finance.create_invoice","finance.sync_erp","finance.view_contracts","finance.manage_integrations","sales.view","sales.create_quote","leads.view","leads.manage"],[i.i.FINANCE_MANAGER]:["finance.view","finance.manage_invoices","finance.create_invoice","finance.sync_erp","finance.view_contracts","finance.manage_integrations"],[i.i.SALES_AGENT]:["sales.view","sales.create_quote","leads.view"],[i.i.CALL_CENTER]:["leads.view","leads.manage"],[i.i.COORDINATOR]:["finance.view_contracts"]},u=(0,a.createContext)(void 0),o=e=>{let{children:n}=e,[r,i]=(0,a.useState)(null),[o,c]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{let e=localStorage.getItem("mavera_user");if(e)try{i(JSON.parse(e))}catch(e){console.error("Failed to parse stored user:",e),localStorage.removeItem("mavera_user")}c(!1)},[]),o)?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,t.jsx)("div",{className:"w-16 h-16 border-4 border-mavera-gold border-t-transparent rounded-full animate-spin"})}):(0,t.jsx)(u.Provider,{value:{user:r,login:e=>{i(e),localStorage.setItem("mavera_user",JSON.stringify(e))},logout:()=>{i(null),localStorage.removeItem("mavera_user")},hasPermission:e=>{if(!r)return!1;let n=(r.roles||[r.role]).flatMap(e=>s[e]||[]);return new Set([...n,...r.customPermissions||[]]).has(e)}},children:n})},c=()=>{let e=(0,a.useContext)(u);if(!e)throw Error("useAuth must be used within an AuthProvider");return e},l=e=>{let{hasPermission:n}=c();return n(e)}},47907:function(e,n,r){"use strict";var t=r(15313);r.o(t,"useParams")&&r.d(n,{useParams:function(){return t.useParams}}),r.o(t,"usePathname")&&r.d(n,{usePathname:function(){return t.usePathname}}),r.o(t,"useRouter")&&r.d(n,{useRouter:function(){return t.useRouter}})},53537:function(e,n,r){"use strict";var t,a;r.d(n,{i:function(){return t}}),(a=t||(t={})).CALL_CENTER="CALL_CENTER",a.SALES_AGENT="SALES_AGENT",a.FINANCE_MANAGER="FINANCE_MANAGER",a.SUPER_ADMIN="SUPER_ADMIN",a.COORDINATOR="COORDINATOR"}},function(e){e.O(0,[971,69,744],function(){return e(e.s=44946)}),_N_E=e.O()}]);